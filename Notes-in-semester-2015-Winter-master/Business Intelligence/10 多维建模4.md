#10 Multi-dimensional Modelling
##五、案例四：客户关系管理
###1.客户关系管理（CRM）
既包含操作处理，又包含分析处理
####目标
* 将分析中心转向**客户**对象
* 支持**以客户为中心**的分析应用

客户事实上是维表，在正常的数据仓库中不会成为事实表，不是分析的中心，这与CRM的目标相冲突
####建设步骤
#####客户数据集成
* 客户信息中姓名和地址的集成
	* 对姓名和地址进行解析，分成更细小的片断
	* 对姓名和地址进行标准化
* 客户数据的更新
	* 新客户的识别
	* 老客户的信息更新  
	可能需要使用数据仓库中已有的历史数据
#####客户信息的分析与挖掘
* 客户特征分类分析：新客户的发现
* 客户赢利分析：优质客户挖掘
* 客户行为分析：客户异常行为的发现
* 客户需求分析
* 客户反映分析
	* 提供一对一服务
	* 防止已有客户的流失
###2.客户维度
CRM的基础是**一致性**的**公共**客户维度
####客户维度的特点
* 特别多的元组  
通常有数百万行以上
* 特别多的属性
* 快速变化的维度  
每天的刷新都可能需要对某些元组进行增删改，当前的处理就会用到更多的元组
####姓名与地址的解析
将姓名与地址属性尽可能地拆分成一些基本的部分
#####解析时的注意事项
* 统一的表示形式
* 地址方面的差异
* 文化方面的差异
#####过于一般的客户维度实例
> *见ppt第8页*
> 
> * 这样的数据在数据仓库中能做的事情仍然不多
> * 因此必须进一步解析，以进行分析处理
####常见的其它客户属性——日期
* 客户维度中包含类型为日期的多个维度属性
* 需要为客户维度建立若干个日期的维度表  
包括出生日期、首次购买日期、最后一次购买日期等等

***参考：日期维度支架***
####常见的其它客户属性——客户分类属性
有些可能长时间不会变化，有些会随周期变化，有些甚至会随时变化

* 性别
* 种族
* 年龄（分级）
* 收入（分级）
* 状况（新潮、活跃、不活跃、封闭……）
* 崭新程度（最后一次购买日期）
* 频率与强度（购买事务总数目与净购买总量）  
以及据此挖掘获得的客户分类属性
* 客户的统计特征  
购买行为、支付行为、产品喜好、挑剔度、违约概率等
####常见的其它客户属性——聚集事实属性
可以将用户最关心的聚集性能度量指标设计为客户维表中的属性

* 消费总额
* 平均消费额
* 单笔消费最高额
* ……
####低基数属性集的维度支架
#####低基数属性
只有少量几个取值的属性，包括枚举、布尔等类型
#####支架维度
* 将一组低基数属性单独构成客户维度的一个维度  
从而使整个模型呈雪花状  
可以起到节约空间的作用  
* 支架维度的数据一般是从外部数据提供者获得的
* 客户维度与支架维度具有相差悬殊的粒度
* 具有不同的管理与加载次数
* 可以节省客户维度表的存储空间
* 如果用户的查询工具坚持使用星型结构，那么可以通过视图定义来隐藏维度支架
####大型变化客户维度
在数据仓库的维度模型中，部分维度属性是会随时间而发生变化的，若只是将这些变化的维度属性值作简单的修正，即在维度表中只保留该维度属性的当前值，这会直接影响到对事实表中该维度属性所对应的事实数据元组的访问，特别是无法根据维度属性值的变化情况来进行分析处理
#####维度表的划分
######稳定维度
######渐变维度  
某些属性虽然会变化，但概率并不高  
渐变维度有保持历史完整性的义务，当前的数据仓库就不能简单地用抹掉的方式进行修改

* 渐变维度的处理方法
	* 改写属性值  
	如果当前的分析应用并不需要历史信息，或是修改可以*逆推*，那么这么做是可行的  
	容易实现，但不能对旧属性的任何历史数据进行维护，无法保证历史一致性
	* **添加维度行**  
	准确跟踪渐变属性的**主要方法**  
	引入新的行用来反映新的属性值  
	原先事实表中的数据仍然与旧的维度保持连接  
	增加了维度行的膨胀  
	可以引入生效或截止日期
	* 添加维度列  
	使用纬度列保存旧的属性值  
	可以跟踪的变化数目受维表的最大维度数目限制
	不适合跟踪维度属性大量变化
	* 类型6（2+3+1）  
	将前三种混合使用，既使用行，又使用列，又同时改写属性值  
	虽然查询效率大大提高，但空间小号太大
######快变维度
* 快变维度的处理办法
	* 微型维度  
	将分析频率高或变化频率大的属性拆成独立的微星维度  
	本质上，将微型维度抽出只适用于原维表中快变属性不多的情况
	* 预设波段  
	将属性转换为按波段变化的范围，即进行离散化处理  
	从而取值限定在小范围内，以减少维度表中的数据量
###3.商务客户体系结构
####深度不变体系
* 层数不变、可以预见的客户维度
* 很容易处理
####深度可变体系
层数不固定的客户维度
#####桥接表——自顶向下
* 客户维度对应客户体系桥中的子客户关键字
#####桥接表——自底向上
* 客户维度对应客户体系桥中的父客户关键字

两种方式看起来都像具有单值关键字的常规事实表一样的可选视图定义
#####体系桥接连表样本行数的计算
	用每层的取值数目乘以层深度（从顶层开始计数），然后将乘积相加起来